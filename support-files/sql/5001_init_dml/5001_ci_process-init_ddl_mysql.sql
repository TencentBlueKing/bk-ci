SET NAMES utf8mb4;
USE devops_ci_process;

-- 空白流水线模板
INSERT IGNORE INTO `T_TEMPLATE` (`VERSION`, `ID`, `TEMPLATE_NAME`, `PROJECT_ID`, `VERSION_NAME`, `CREATOR`, `CREATED_TIME`, `TEMPLATE`, `TYPE`, `CATEGORY`, `LOGO_URL`, `SRC_TEMPLATE_ID`, `STORE_FLAG`, `WEIGHT`) VALUES
  (1, '072d516d300b4812a4f652f585eacc36', 'Blank', '', 'init', '', '2019-05-23 16:24:02', '{\n  \"name\" : \"Blank\",\n  \"desc\" : \"\",\n  \"stages\" : [ {\n    \"containers\" : [ {\n      \"@type\" : \"trigger\",\n      \"name\" : \"Trigger\",\n      \"elements\" : [ {\n        \"@type\" : \"manualTrigger\",\n        \"name\" : \"Manual\",\n        \"id\" : \"T-1-1-1\",\n        \"properties\" : [ ]\n      } ]\n    } ],\n    \"id\" : \"stage-1\"\n  }]\n}', 'PUBLIC', '', NULL, NULL, 0, 100);

-- Stage预置标签
INSERT IGNORE INTO `T_PIPELINE_STAGE_TAG` (`ID`, `STAGE_TAG_NAME`, `WEIGHT`, `CREATOR`, `MODIFIER`, `CREATE_TIME`, `UPDATE_TIME`) VALUES
('28ee946a59f64949a74f3dee40a1bda4','Build',99,'system','system','2020-03-03 18:07:12','2020-03-19 16:29:38');
INSERT IGNORE INTO `T_PIPELINE_STAGE_TAG` (`ID`, `STAGE_TAG_NAME`, `WEIGHT`, `CREATOR`, `MODIFIER`, `CREATE_TIME`, `UPDATE_TIME`) VALUES
	('53b4d3f38e3e425cb1aaa97aa1b37857','Deploy',0,'system','system','2020-03-19 18:00:04','2020-03-19 18:00:04');
INSERT IGNORE INTO `T_PIPELINE_STAGE_TAG` (`ID`, `STAGE_TAG_NAME`, `WEIGHT`, `CREATOR`, `MODIFIER`, `CREATE_TIME`, `UPDATE_TIME`) VALUES
	('d0a06f6986fa4670af65ccad7bb49d3a','Test',50,'system','system','2020-03-19 16:29:45','2020-03-19 16:29:45');

-- 配置流水线规则
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('0042ea36599a4adf8c26cf23f5edca45', 'MINUTE', 'BUILD_NUM', 'DefaultCalendarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('110575a0246f491aa297c9bd2452c34b', 'DAY_OF_YEAR', 'BUILD_NUM', 'DefaultCalendarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('20d66e6e9eb04df7ac029cbacddda8ef', 'MONTH_OF_YEAR', 'BUILD_NUM', 'BkCalendarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('4f78736b80d449c192cc96bfb9de9dbe', 'DATE:\"(.+?)\"', 'BUILD_NUM', 'BkCalendarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('69209588979d4c08b971a653708e0ce1', 'HOUR_OF_DAY', 'BUILD_NUM', 'DefaultCalendarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('8bd2fe3620ec408b8310ed20d37b0ac5', 'YEAR', 'BUILD_NUM', 'DefaultCalendarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('bb0d1167f20d4d3dbd131ef55fe8304c', 'SECOND', 'BUILD_NUM', 'DefaultCalendarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('c3b2b8a80b114b48bbe535bf075fdc1f', 'DAY_OF_MONTH', 'BUILD_NUM', 'DefaultCalendarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('faadf27e703b4ee08b98fd6e4958e2b4', 'BUILD_NO_OF_DAY', 'BUILD_NUM', 'BuildNoOfDayProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('c5946af9754946d6a0ed9d1f63107bf1', 'BK_CI_PROJECT_NAME_CN', 'BUILD_NUM', 'BkVarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('ce759c669c6642d6bfee7faf03f717a5', 'BK_CI_REPO_GIT_WEBHOOK_SOURCE_BRANCH', 'BUILD_NUM', 'BkVarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('03a12d6607734b858c5e76acb5e4add2', 'BK_CI_BUILD_NUM', 'BUILD_NUM', 'BkVarProcessor');
INSERT IGNORE INTO `T_PIPELINE_RULE`(`ID`, `RULE_NAME`, `BUS_CODE`, `PROCESSOR`) VALUES ('5d6a9ab5f012418ab4827fcb98f564ad', 'BK_CI_PIPELINE_NAME', 'BUILD_NUM', 'BkVarProcessor');

-- 更新模板表UPDATE_TIME为空的历史记录
UPDATE T_TEMPLATE SET UPDATE_TIME=CREATED_TIME WHERE UPDATE_TIME IS NULL;